<html>
  <head>
    <title>BINARY SENDER</title>
    <style></style>
    <script>
      var IP = "192.168.1.100";
      var connecting = false;
      var binaryList;
      let socket = new WebSocket("ws://" + IP + ":81");
      function checkSocket() {
        if (socket.readyState > 1) {
          socket = new WebSocket("ws://" + IP + ":81");
          console.log("Reconnecting to Websocket....");
          connecting = true;
        } else {
          if (connecting == true && socket.readyState == 1) {
            connecting = false;
            console.log("Connected sucessfully to WebSocket :)");
          }
        }
      }
      window.setInterval("checkSocket", 500);
      socket.onerror = function(error) {
        alert("The communication system is currently experiencing an error:\n\n" + error.message);
      }
      function updateBox() {
        document.getElementById("button").innerHTML = (binaryList[document.getElementById("input").value]).toString();
        if (binaryList[document.getElementById("input").value] == 0) {
          document.getElementById("button").style.backgroundColor = "#08afaf";
        } else {
          document.getElementById("button").style.backgroundColor = "lightgreen";
        }
      }
      socket.onmessage = function(message) {
        var translate = "" + message.data;
        if (translate == "ping") {} else {
          if (translate.substring(0, 1) != "[") {
            alert("Alert:\n" + translate);
          } else {
            binaryList = eval(translate);
            updateBox();
            document.getElementById("input").max = binaryList.length - 1;
          }
        }
      }
      function sendBit(bit) {
        socket.send((document.getElementById("input").value).toString() + bit.toString());
      }
    </script>
  </head>
  <body>
    <h1>Binary Message Transfer</h1>
    <label for="input">Binary Communication Port: </label>
    <input type="number" id="input" min="0" max="0" oninput="updateBox()" value="0">
    <br><br>
    <button id="button" onmousedown="sendBit(1)" onmouseup="sendBit(0)">0</button>
  </body>
</html>